{% extends 'base.html' %}
{% load static %}
{% load i18n %}
{% load humanize %}

{% block title %}{% trans 'Main' %}{% endblock title %}

{% block head %}
<link rel="stylesheet" href="{% static 'styles/main.css' %}"/>
{% endblock head %}

{% block content %}
<section class="horizontal">

    <form id="friend_form" method="get">
        <input id="friend_form_input" type="hidden" value="" name="dm">
    </form>
    <form id="page_form" method="get">
        <input id="page_form_input" type="hidden" value="" name="page">
    </form>
    <form id="post_detail_form" method="get">
        <input id="post_detail_form_input" type="hidden" value="" name="pd">
    </form>
    <form id="profile_view_form" method="get">
        <input id="profile_view_form_input" type="hidden" value="" name="pv">
    </form>
    <form id="delete_post_form" method="post">{% csrf_token %}</form>

    <div id="nav" class="nav">
        <div class="nav_header vertical">
            <div class="search_bar" onmouseover="search_icon.classList.add('fa-beat');" onmouseout="search_icon.classList.remove('fa-beat');">
                <input class="search_bar_input cur_text_dark font_light" type="text" placeholder="{% trans 'Search for anything' %}">
                <i id="search_icon" class="fa fa-search cur_pointer_dark font_light"></i>
            </div>
            <div class="profile_bar dropdown">
                <img id="profile_pic" class="profile_bar_img cur_pointer_dark" onclick="open_section(image_section, this.src);" src="{{ request.user.image.url }}">
                <a class="profile_bar_text font_light">{{ request.user.username }}</a>
                <i class="profile_bar_i fa fa-ellipsis-vertical cur_pointer_dark dropbtn font_light" onclick="on_dropdown_click(dropdown_profile_bar);"></i>
                <div id="dropdown_profile_bar" class="dropdown-content cur_pointer_dark">
                    <div class="drop_item horizontal" onclick="page('profile');" onmouseover="profile_profile_icon.classList.add('fa-flip');" onmouseout="profile_profile_icon.classList.remove('fa-flip');">
                        <i id="profile_profile_icon" class="fa fa-address-card drop_item_icon font_light"></i>
                        <a class="drop_item_text font_light">{% trans "Profile" %}</a>
                    </div>
                </div>
            </div>
        </div>
        <div class="grouper width_auto">
            <i class="fa fa-angle-down font_light"></i>
            <a class="grouper_text font_light">{% trans "MENU" %}</a>
        </div>
        {% with page=request.GET.page|default:''%}
            {% if page == 'profile'%}  
        <div class="item_active cur_pointer_dark" onclick="page('profile');" onmouseover="profile_icon.classList.add('fa-bounce');" onmouseout="profile_icon.classList.remove('fa-bounce');">
            {% else %}
        <div class="item cur_pointer_dark" onclick="page('profile');" onmouseover="profile_icon.classList.add('fa-bounce');" onmouseout="profile_icon.classList.remove('fa-bounce');">
            {% endif %}
        {% endwith %}
            <i id='profile_icon' class="item_icon fa fa-user-circle font_light"></i>
            <a class="item_text font_light">{% trans "Profile" %}</a>
        </div>
        {% with page=request.GET.page|default:''%}
            {% if page == 'settings'%}  
        <div class="item_active cur_pointer_dark" onclick="page('settings');" onmouseover="settings_icon.classList.add('fa-spin');" onmouseout="settings_icon.classList.remove('fa-spin');">
            {% else %}
        <div class="item cur_pointer_dark" onclick="page('settings');" onmouseover="settings_icon.classList.add('fa-spin');" onmouseout="settings_icon.classList.remove('fa-spin');">
            {% endif %}
        {% endwith %}
            <i id='settings_icon' class="item_icon fa fa-gear font_light"></i>
            <a class="item_text font_light">{% trans "Settings" %}</a>
        </div>
        {% with page=request.GET.page|default:'' post_detail=request.GET.pd|default:'' %}
            {% if page == 'posts' or post_detail != '' %}      
            <div class="item_active cur_pointer_dark" onclick="page('posts')" onmouseover="posts_icon.classList.add('fa-beat');" onmouseout="posts_icon.classList.remove('fa-beat');">
            {% else %}
            <div class="item cur_pointer_dark" onclick="page('posts')" onmouseover="posts_icon.classList.add('fa-beat');" onmouseout="posts_icon.classList.remove('fa-beat');">
            {% endif %}
        {% endwith %}
            <i id="posts_icon" class="item_icon fa fa-compass font_light"></i>
            <a class="item_text font_light">{% trans "Posts" %}</a>
        </div>
        <div class="grouper width_auto">
            <i class="fa fa-angle-down font_light"></i>
            <a class="grouper_text font_light">{% trans "CHANNELS" %}</a>
        </div>
        <div class="item cur_pointer_dark" onmouseover="group_icon.classList.add('fa-bounce');" onmouseout="group_icon.classList.remove('fa-bounce');">
            <i id="group_icon" class="item_icon fa fa-users font_light"></i>
            <a class="item_text font_light">{% trans "Group" %}</a>
        </div>
        <div class="grouper width_auto">
            <i class="fa fa-angle-down font_light"></i>
            <a class="grouper_text font_light">{% trans "FRIENDS" %}</a>
        </div>
        {% for friend in friends %}
            {% with friend_get=request.GET.dm|default:'' %}
                {% if friend_get and friend_get == friend.hash %}
        <div class="friend item_active cur_pointer_dark dropdown" value="{{ friend.hash }}">
                {% else %}
        <div class="friend item cur_pointer_dark dropdown" value="{{ friend.hash }}">
                {% endif %}
            {% endwith %}
            <img src="{{ friend.image.url }}" class="item_img" value="{{ friend.hash }}"></img>
            <a class="item_text font_light" value="{{ friend.hash }}">{{ friend.username }}</a>
            {% if friend.is_online %}
            <i class="fa fa-circle font_green font_8"></i>
            {% endif %}
            <i class="profile_bar_i fa fa-ellipsis-vertical cur_pointer_dark dropbtn dont font_light" onclick="on_dropdown_click(dropdown_friend_{{ friend.id }});"></i>
            <div id="dropdown_friend_{{ friend.id }}" class="dropdown-content dont">
                <div class="drop_item horizontal dont" onclick="profile_view_form_input.value='{{ friend.hash }}';profile_view_form.submit();" onmouseover="friend_profile_icon_{{ friend.id }}.classList.add('fa-flip');" onmouseout="friend_profile_icon_{{ friend.id }}.classList.remove('fa-flip');">
                    <i id="friend_profile_icon_{{ friend.id }}" class="drop_item_icon fa fa-address-card font_light dont"></i>
                    <a class="drop_item_text font_light dont">{% trans "Profile" %}</a>
                </div>
            </div>
        </div>
        {% endfor %}
        <div class="item cur_pointer_dark" onclick="open_section(friend_section);" onmouseover="plus_icon.classList.add('fa-beat');" onmouseout="plus_icon.classList.remove('fa-beat');">
            <i id="plus_icon" class="item_icon fa fa-plus-square font_light"></i>
            <a class="item_text font_light">{% trans "Add Friends" %}</a>
        </div>
        {% if requested_friends %}
        <div id="requested_friends_grouper" class="grouper width_auto">
            <i class="fa fa-angle-down font_light"></i>
            <a class="grouper_text font_light">{% trans "SENT FRIEND REQUESTS" %}</a>
        </div>
            {% for requested_friend in requested_friends %}
        <div class="item cur_pointer_dark dropdown">
            <img src="{{ requested_friend.receiver.image.url }}" class="item_img"></img>
            <a class="item_text font_light">{{ requested_friend.receiver.username }}</a>
            <i class="profile_bar_i fa fa-ellipsis-vertical cur_pointer_dark dropbtn font_light dont" onclick="on_dropdown_click(dropdown_friend_request_{{ requested_friend.id }});"></i>
            <div id="dropdown_friend_request_{{ requested_friend.id }}" class="dropdown-content dont">
                <div class="drop_item horizontal dont" onclick="profile_view_form_input.value='{{ requested_friend.hash }}';profile_view_form.submit();" onmouseover="request_profile_icon_{{ requested_friend.id }}.classList.add('fa-bounce');" onmouseout="request_profile_icon_{{ requested_friend.id }}.classList.remove('fa-bounce');">
                    <i id="request_profile_icon_{{ requested_friend.id }}" class="fa fa-address-card dont drop_item_icon font_light"></i>
                    <a class="drop_item_text font_light dont">{% trans "Profile" %}</a>
                </div>
            </div>
        </div>
            {% endfor %}
        {% endif %}
    </div>
    
    <div id="main" class="main">
    {% with profile_view=request.GET.pv|default:'' %}
        {% if profile_view != '' %}
        <div id="chat_messages" class="chat_messages posts vertical width_max scroll_y animations_0" onscroll="checkScroll();">
            <div class="shadow_3">&nbsp;</div>
            <div id="scroll_top" class="item cur_pointer_dark" onclick="scrollToTop();">
                <i class="item_icon fa fa-arrow-up font_light"></i>
                <a class="item_text font_light">{% trans "Scroll to top" %}</a>
            </div>
            <div class="profile_box">
                <div class="field">
                    <img class="profile_box_image cur_pointer_dark" src="{{ user.image.url }}" onclick="open_section(image_section, this.src)">
                </div>
                <div class="field horizontal">
                    <a class="label profile_label">{{ user.username }}</a>
                </div>
                <div class="field horizontal">
                    <a class="label">{{ user.email }}</a>
                </div>
            </div>
            <div class="field horizontal">
                <button class="button cur_pointer_dark" onclick="friend_request('{{ user.username }}');">{% trans "SEND FRIEND REQUEST" %}</button>
            </div>
            <div id="scroll_bottom" class="item cur_pointer_dark" onclick="scrollToBottom();">
                <i class="item_icon fa fa-arrow-down font_light"></i>
                <a class="item_text font_light">{% trans "Scroll to bottom" %}</a>
            </div>
        </div>
        {% endif %}
    {% endwith %}

    {% with page=request.GET.page|default:'' %}
        {% if page == 'settings' %}
        <div class="shadow_3">&nbsp;</div>
        <div id="scroll_top" class="item cur_pointer_dark" onclick="scrollToTop();">
            <i class="item_icon fa fa-arrow-up font_light"></i>
            <a class="item_text font_light">{% trans "Scroll to top" %}</a>
        </div>
        <div class="box center">
            <div class="box_body">
                <div class="field horizontal align_vertical_center">
                    <i class="fa fa-globe font_light font_20 margin_right_20"></i>
                    <label class="label">{% trans "Language:" %}</label>
                    <div class="custom-select width_100 right font_16 cur_pointer_dark">
                        <select name="languages" id="languages" class="right font_16">
                            <option class="cur_pointer_dark" value="en">{% trans "English" %}</option>
                            <option class="cur_pointer_dark" value="ru">{% trans "Russian" %}</option>
                            <option class="cur_pointer_dark" value="tr">{% trans "Turkish" %}</option>
                            <option class="cur_pointer_dark" value="tk">{% trans "Turkmen" %}</option>
                        </select>
                    </div>
                </div>
            </div>
            <div class="box_body">
                <div class="field horizontal align_vertical_center">
                    <i class="fa fa-computer-mouse font_light font_20 margin_right_20"></i>
                    <label class="label">{% trans "Cursor:" %}</label>
                    <label class="switch right">
                        <input id="cursor" type="checkbox" onchange="cursor();" checked>
                        <span class="slider round cur_pointer_dark"></span>
                    </label>
                </div>
            </div>
            <div class="box_body">
                <div class="field horizontal align_vertical_center">
                    <i class="fa fa-volume-high font_light font_20 margin_right_20"></i>
                    <label class="label">{% trans "Sounds:" %}</label>
                    <label class="switch right">
                        <input type="checkbox" checked>
                        <span class="slider round cur_pointer_dark"></span>
                    </label>
                </div>
            </div>
            <div class="box_body">
                <div class="field horizontal align_vertical_center">
                    <i class="fa fa-music font_light font_20 margin_right_20"></i>
                    <label class="label">{% trans "Animations:" %}</label>
                    <label class="switch right">
                        <input id="animations" type="checkbox" onchange="animaitons();" checked>
                        <span class="slider round cur_pointer_dark"></span>
                    </label>
                </div>
            </div>
            <div class="box_body">
                <div class="field horizontal align_vertical_center">
                    <i class="fa fa-bell font_light font_20 margin_right_20"></i>
                    <label class="label">{% trans "Notifications:" %}</label>
                    <label class="switch right">
                        <input type="checkbox" checked>
                        <span class="slider round cur_pointer_dark"></span>
                    </label>
                </div>
            </div>
        </div>
        <div id="scroll_bottom" class="item cur_pointer_dark" onclick="scrollToBottom();">
            <i class="item_icon fa fa-arrow-down font_light"></i>
            <a class="item_text font_light">{% trans "Scroll to bottom" %}</a>
        </div>
        {% else %}
        <input id="cursor" class='hidden' type="checkbox" onchange="cursor();" checked>
        <input id="animations" class='hidden' type="checkbox" onchange="animaitons();" checked>
        {% endif %}
    {% endwith %}

    {% with page=request.GET.page|default:'' %}
        {% if page == 'profile' %}
        <div id="chat_messages" class="chat_messages posts vertical width_max scroll_y animations_0" onscroll="checkScroll();">
            <div class="shadow_3">
                <div class="field horizontal cur_pointer_dark right margin_top_10 margin_right_20 font_light" onclick="open_section(edit_profile_section);" onmouseover="profile_edit.classList.add('fa-bounce');" onmouseout="profile_edit.classList.remove('fa-bounce');">
                    <label class="label">{% trans "Edit Profile" %}</label>
                    <i id="profile_edit" class="fa fa-pencil post_item"></i>
                </div>
            </div>
            <div id="scroll_top" class="item cur_pointer_dark" onclick="scrollToTop();">
                <i class="item_icon fa fa-arrow-up font_light"></i>
                <a class="item_text font_light">{% trans "Scroll to top" %}</a>
            </div>
            <div class="profile_box">
                <div class="field">
                    <img class="profile_box_image cur_pointer_dark" src="{{ request.user.image.url }}" onclick="open_section(image_section, this.src)">
                </div>
                <div class="field horizontal">
                    <a class="label profile_label">{{ request.user.username }}</a>
                </div>
                <div class="field horizontal">
                    <a class="label">{{ request.user.email }}</a>
                </div>
                <div class="field horizontal">
                    <button class="button red cur_pointer_dark" onclick="window.location={% url 'logout' %};">{% trans "LOGOUT" %}</button>
                </div>
                <!--
                <div class="field horizontal cur_pointer_dark font_light" onclick="" onmouseover="profile_edit.classList.add('fa-bounce');" onmouseout="profile_edit.classList.remove('fa-bounce');">
                    <label class="label">{% trans "Edit Profile" %}</label>
                    <i id="profile_edit" class="fa fa-pencil post_item"></i>
                </div>
                <div class="field horizontal">
                    <a class="label">{% trans "First Name:" %}</a>
                    <a class="label">{{ request.user.first_name }}</a>
                </div>
                <div class="field horizontal">
                    <a class="label">{% trans "Last Name:" %}</a>
                    <a class="label">{{ request.user.last_name }}</a>
                </div>
                <div class="field horizontal">
                    <a class="label">{% trans "Bio:" %}</a>
                    <a class="label">{{ request.user.bio }}</a>
                </div>
                <div class="field horizontal">
                    <a class="label">{% trans "Location:" %}</a>
                    <a class="label">{{ request.user.location }}</a>
                </div>
                <div class="field horizontal">
                    <a class="label">{% trans "Last Seen:" %}</a>
                    <a class="label">{{ request.user.last_login }}</a>
                </div>
                <div class="field horizontal">
                    <a class="label">{% trans "Birth Date:" %}</a>
                    <a class="label">{{ request.user.birth_date }}</a>
                </div>
                <div class="field horizontal">
                    <a class="label">{% trans "Gender:" %}</a>
                    <a class="label">{{ request.user.gender }}</a>
                </div>
                -->
            </div>
            <!--
            <div class="post_box">       
                {% for post in posts %}
                <div class="post box center">
                    {% if post.user == request.user %}
                    <div class="box_head dark_blue">
                    {% else %}
                    <div class="box_head">
                    {% endif %}
                        <div class="field horizontal">
                            <img class="post_user_image" src="{{ post.user.image.url }}"/>
                            <a class="box_head_title">{{ post.user.username }}</a>
                        </div>
                        {% if post.user == request.user %}
                            {% if post.image %}
                        <div class="field horizontal right cur_pointer_dark font_light" onclick="delete_post_form.action='{% url 'delete_post' post.pk %}';edit_post_form.action='{% url 'edit_post' post.pk %}';open_section(edit_post_section, '{{ post.image.url }}', '{{ post.content }}', post_image_{{ post.id }});" onmouseover="post_icon_{{ post.id }}.classList.add('fa-bounce');" onmouseout="post_icon_{{ post.id }}.classList.remove('fa-bounce');">
                            {% else %}
                        <div class="field horizontal right cur_pointer_dark font_light" onclick="delete_post_form.action='{% url 'delete_post' post.pk %}';edit_post_form.action='{% url 'edit_post' post.pk %}';open_section(edit_post_section, null, '{{ post.content }}');" onmouseover="post_icon_{{ post.id }}.classList.add('fa-bounce');" onmouseout="post_icon_{{ post.id }}.classList.remove('fa-bounce');">
                            {% endif %}
                            <label class="label post_item">{% trans "Edit Post" %}</label>
                            <i id="post_icon_{{ post.id }}" class="fa fa-pencil"></i>
                        </div>
                        {% endif %}
                    </div>
                    <div class="box_body">
                        {% if post.image %}
                        <div class="field">
                            <img id="post_image_{{ post.id }}" class="post_image cur_pointer_dark" src="{{ post.image.url }}" onclick="open_section(image_section, this.src);"/>
                        </div>
                        {% endif %}
                        {% if post.content %}
                        <div class="field left">
                            <pre class="post_content paragraph font_16">{{ post.content }}</pre>
                        </div>
                        {% endif %}
                    </div>
                    <div class="box_footer">
                        <div class="relative horizontal">
                            <div class="field absolute_left">
                                <label class="post_date_time label">{{ post.created_date_time|naturaltime }}</label>
                            </div>
                            <div class="field horizontal font_light center fa-bounce-hover cur_pointer_dark" onclick="post_detail_form_input.value='{{ post.hash }}';post_detail_form.submit();">
                                {% if post.comments.all.count %}
                                <label class="label">{{ post.comments.all.count }}</label>
                                {% else %}
                                <label class="label">0</label>
                                {% endif %}
                                <i class="fa fa-message font_light post_item font_blue"></i>
                            </div>
                            <div class="field horizontal absolute_right">
                                <i class="fa fa-thumbs-up font_light fa-shake-hover post_item cur_pointer_dark font_green"></i>
                                <label class="label">0</label>
                                <i class="fa fa-thumbs-down font_light fa-shake-hover post_item cur_pointer_dark font_red"></i>
                                <label class="label">0</label>
                            </div>
                        </div>
                    </div>
                </div>
                {% endfor %}
            </div>
            -->
            <div id="scroll_bottom" class="item cur_pointer_dark" onclick="scrollToBottom();">
                <i class="item_icon fa fa-arrow-down font_light"></i>
                <a class="item_text font_light">{% trans "Scroll to bottom" %}</a>
            </div>
        </div>
        {% endif %}
    {% endwith %}

    {% with friend=request.GET.dm|default:'' %}
        {% if friend != '' %}
        <div class="shadow">&nbsp;</div>
        <div id="scroll_top_chat" class="item cur_pointer_dark" onclick="scrollToTop();">
            <i class="item_icon fa fa-arrow-up font_light"></i>
            <a class="item_text font_light">{% trans "Scroll to top" %}</a>
        </div>
        <div id="chat_messages" class="chat_messages smooth_scroll vertical width_max scroll_y animations_0" onscroll="checkScroll();">
            <div class="message_user spacer_2">&nbsp;</div>
            {% for message in messages %}
                {% if message.sender == request.user %}
            <div class="message_box_rigth right margin_right_20">
                <div class="message_right">
                    <a class="message_text font_light">{{ message.content }}</a>
                </div>
                <div>{{ message.sent_date_time|naturaltime }}</div>
            </div>
                {% else %}
            <div class="message_user message_box">
                <div class="user_field top cur_pointer_dark" onclick="profile_view_form_input.value='{{ message.sender.hash }}';profile_view_form.submit();">
                    <img class="user_field_img radius_20" src="{{ message.sender.image.url }}"></img>
                </div>
                <div class="message_field">
                    <a class="message_field_text font_light cur_pointer_dark" onclick="profile_view_form_input.value='{{ message.sender.hash }}';profile_view_form.submit();">{{ message.sender.username }}</a>
                    <div class="message">
                        <a class="message_text font_light">{{ message.content }}</a>
                    </div>
                    <div>{{ message.sent_date_time|naturaltime }}</div>
                </div>
            </div>
                {% endif %} 
            {% endfor %}
            <div id="chat_spacer" class="message_user spacer">&nbsp;</div>
        </div>
        <div id="scroll_bottom_chat" class="item cur_pointer_dark" onclick="scrollToBottom();">
            <i class="item_icon fa fa-arrow-down font_light"></i>
            <a class="item_text font_light">{% trans "Scroll to bottom" %}</a>
        </div>
        <div id="send_form" class="sender bottom width_600">
            <i class="fa fa-microphone sender_icon cur_pointer_dark font_light fa-fade-hover"></i>
            <input id="chat_message_input" class="sender_input cur_text_dark font_light" name="content" type="text" placeholder="{% trans 'Type a message' %}">
            <i class="fa fa-plus-square sender_icon cur_pointer_dark font_light fa-beat-hover"></i>
            <i id="chat_message_submit" class="fa fa-paper-plane sender_icon cur_pointer_dark font_light fa-shake-hover" onclick="send_message();"></i>
        </div>
        {% endif %}
    {% endwith %}

    {% with page=request.GET.page|default:'' %}
        {% if page == 'posts' %}
        <div class="shadow_3">
            <div id="add_post" class="button cur_pointer_dark" onclick="open_section(post_section);">
                <i class="item_icon fa fa-plus-square font_light"></i>
                <a class="item_text font_light">{% trans "Share Post" %}</a>
            </div>
        </div>
        <div id="scroll_top" class="item cur_pointer_dark" onclick="scrollToTop();">
            <i class="item_icon fa fa-arrow-up font_light"></i>
            <a class="item_text font_light">{% trans "Scroll to top" %}</a>
        </div>
        <div id="chat_messages" class="chat_messages posts vertical width_max scroll_y animations_0" onscroll="checkScroll();">
            <div>&nbsp;</div>
            <div>&nbsp;</div>
            <div>&nbsp;</div>
            {% for post in posts %}
            <div class="post box center">
                {% if post.user == request.user %}
                <div class="box_head dark_blue">
                    <div class="field horizontal cur_pointer_dark" onclick="page('profile');">
                {% else %}
                <div class="box_head">
                    <div class="field horizontal cur_pointer_dark" onclick="profile_view_form_input.value='{{ post.user.hash }}';profile_view_form.submit();">
                {% endif %}
                        <img class="post_user_image" src="{{ post.user.image.url }}"/>
                        <a class="box_head_title">{{ post.user.username }}</a>
                    </div>
                    {% if post.user == request.user %}
                        {% if post.image %}
                    <div class="field horizontal right cur_pointer_dark font_light" onclick="delete_post_form.action='{% url 'delete_post' post.pk %}';edit_post_form.action='{% url 'edit_post' post.pk %}';open_section(edit_post_section, '{{ post.image.url }}', '{{ post.content }}', post_image_{{ post.id }});" onmouseover="post_icon_{{ post.id }}.classList.add('fa-bounce');" onmouseout="post_icon_{{ post.id }}.classList.remove('fa-bounce');">
                        {% else %}
                    <div class="field horizontal right cur_pointer_dark font_light" onclick="delete_post_form.action='{% url 'delete_post' post.pk %}';edit_post_form.action='{% url 'edit_post' post.pk %}';open_section(edit_post_section, null, '{{ post.content }}');" onmouseover="post_icon_{{ post.id }}.classList.add('fa-bounce');" onmouseout="post_icon_{{ post.id }}.classList.remove('fa-bounce');">
                        {% endif %}
                        <label class="label post_item">{% trans "Edit Post" %}</label>
                        <i id="post_icon_{{ post.id }}" class="fa fa-pencil"></i>
                    </div>
                    {% endif %}
                </div>
                <div class="box_body">
                    {% if post.image %}
                    <div class="field">
                        <img id="post_image_{{ post.id }}" class="post_image cur_pointer_dark" src="{{ post.image.url }}" onclick="open_section(image_section, this.src);"/>
                    </div>
                    {% endif %}
                    {% if post.content %}
                    <div class="field left">
                        <pre class="post_content paragraph font_16">{{ post.content }}</pre>
                    </div>
                    {% endif %}
                </div>
                <div class="box_footer">
                    <div class="relative horizontal">
                        <div class="field absolute_left">
                            <label class="post_date_time label">{{ post.created_date_time|naturaltime }}</label>
                        </div>
                        <div class="field horizontal font_light center fa-bounce-hover cur_pointer_dark" onclick="post_detail_form_input.value='{{ post.hash }}';post_detail_form.submit();">
                            {% if post.comments.all.count %}
                            <label class="label">{{ post.comments.all.count }}</label>
                            {% else %}
                            <label class="label">0</label>
                            {% endif %}
                            <i class="fa fa-message font_light post_item font_blue"></i>
                        </div>
                        <div class="field horizontal absolute_right">
                            <i class="fa fa-thumbs-up font_light fa-shake-hover post_item cur_pointer_dark font_green" onclick="window.location='{% url 'like_post' post.id %}';"></i>
                            {% if post.liked_users.all.count %}
                            <label class="label">{{ post.liked_users.all.count }}</label>
                            {% else %}
                            <label class="label">0</label>
                            {% endif %}
                            <i class="fa fa-thumbs-down font_light fa-shake-hover post_item cur_pointer_dark font_red" onclick="window.location='{% url 'dislike_post' post.id %}';"></i>
                            {% if post.disliked_users.all.count %}
                            <label class="label">{{ post.disliked_users.all.count }}</label>
                            {% else %}
                            <label class="label">0</label>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endfor %}
            <div>&nbsp;</div>
            <div>&nbsp;</div>
        </div>
        <div id="scroll_bottom" class="item cur_pointer_dark" onclick="scrollToBottom();">
            <i class="item_icon fa fa-arrow-down font_light"></i>
            <a class="item_text font_light">{% trans "Scroll to bottom" %}</a>
        </div>
        {% endif %}
    {% endwith %}

    {% with post_detail=request.GET.pd|default:'' %}
        {% if post_detail != '' %}
        <div class="shadow_3">
            <div class="margin_left_20 margin_right_20">&nbsp;</div>
            <div id="cancel_post_detail" class="item_active cur_pointer_dark font_light" onclick="page('posts');">
                <i class="item_icon fa fa-arrow-left"></i>
                <a class="item_text font_light">{% trans "Back" %}</a>
            </div>
            <div class="right">&nbsp;</div>
        </div>
        <div id="scroll_top" class="item cur_pointer_dark" onclick="scrollToTop();">
            <i class="item_icon fa fa-arrow-up font_light"></i>
            <a class="item_text font_light">{% trans "Scroll to top" %}</a>
        </div>
        <div id="chat_messages" class="chat_messages posts vertical width_max scroll_y animations_0" onscroll="checkScroll();">
            <div>&nbsp;</div>
            <div>&nbsp;</div>
            <div>&nbsp;</div>
            {% if post %}
            <div class="post box center">
                {% if post.user == request.user %}
                <div class="box_head dark_blue">
                    <div class="field horizontal cur_pointer_dark" onclick="page('profile');">
                {% else %}
                <div class="box_head">
                    <div class="field horizontal cur_pointer_dark" onclick="profile_view_form_input.value='{{ post.user.hash }}';profile_view_form.submit();">
                {% endif %}
                        <img class="post_user_image" src="{{ post.user.image.url }}"/>
                        <a class="box_head_title">{{ post.user.username }}</a>
                    </div>
                    {% if post.user == request.user %}
                        {% if post.image %}
                    <div class="field horizontal right cur_pointer_dark font_light" onclick="delete_post_form.action='{% url 'delete_post' post.pk %}';edit_post_form.action='{% url 'edit_post' post.pk %}';open_section(edit_post_section, '{{ post.image.url }}', '{{ post.content }}', post_image_{{ post.id }});" onmouseover="post_icon_{{ post.id }}.classList.add('fa-bounce');" onmouseout="post_icon_{{ post.id }}.classList.remove('fa-bounce');">
                        {% else %}
                    <div class="field horizontal right cur_pointer_dark font_light" onclick="delete_post_form.action='{% url 'delete_post' post.pk %}';edit_post_form.action='{% url 'edit_post' post.pk %}';open_section(edit_post_section, null, '{{ post.content }}');" onmouseover="post_icon_{{ post.id }}.classList.add('fa-bounce');" onmouseout="post_icon_{{ post.id }}.classList.remove('fa-bounce');">
                        {% endif %}
                        <label class="label post_item">{% trans "Edit Post" %}</label>
                        <i id="post_icon_{{ post.id }}" class="fa fa-pencil"></i>
                    </div>
                    {% endif %}
                </div>
                <div class="box_body">
                    {% if post.image %}
                    <div class="field">
                        <img id="post_image_{{ post.id }}" class="post_image cur_pointer_dark" src="{{ post.image.url }}" onclick="open_section(image_section, this.src);"/>
                    </div>
                    {% endif %}
                    {% if post.content %}
                    <div class="field left">
                        <pre class="post_content paragraph font_16">{{ post.content }}</pre>
                    </div>
                    {% endif %}
                </div>
                <div class="box_footer">
                    <div class="relative horizontal">
                        <div class="field absolute_left">
                            <label class="post_date_time label">{{ post.created_date_time|naturaltime }}</label>
                        </div>
                        <div class="field horizontal font_light center fa-bounce-hover cur_pointer_dark">
                            {% if post.comments.all.count %}
                            <label id="post_comment_count" class="label">{{ post.comments.all.count }}</label>
                            {% else %}
                            <label id="post_comment_count" class="label">0</label>
                            {% endif %}
                            <i class="fa fa-message font_light post_item font_blue"></i>
                        </div>
                        <div class="field horizontal absolute_right">
                            <i class="fa fa-thumbs-up font_light fa-shake-hover post_item cur_pointer_dark font_green" onclick="like_post();"></i>
                            {% if post.liked_users.all.count %}
                            <label id="likes" class="label">{{ post.liked_users.all.count }}</label>
                            {% else %}
                            <label id="likes" class="label">0</label>
                            {% endif %}
                            <i class="fa fa-thumbs-down font_light fa-shake-hover post_item cur_pointer_dark font_red" onclick="dislike_post();"></i>
                            {% if post.disliked_users.all.count %}
                            <label id="dislikes" class="label">{{ post.disliked_users.all.count }}</label>
                            {% else %}
                            <label id="dislikes" class="label">0</label>
                            {% endif %}
                        </div>
                    </div>
                </div>
            </div>
            {% endif %}
            {% for comment in comments %}
                {% if comment.user == request.user %}
            <div class="right">
                <div class="message_box_rigth right margin_right_20">
                    <div class="message_right">
                        <a class="message_text font_light">{{ comment.content }}</a>
                    </div>
                    <div>{{ comment.sent_date_time|naturaltime }}</div>
                </div>
            </div>
                {% else %}
            <div class="message_user message_box left">
                <div class="user_field top cur_pointer_dark" onclick="profile_view_form_input.value='{{ comment.user.hash }}';profile_view_form.submit();">
                    <img class="user_field_img radius_20" src="{{ comment.user.image.url }}"></img>
                </div>
                <div class="message_field">
                    <a class="message_field_text font_light cur_pointer_dark" onclick="profile_view_form_input.value='{{ comment.user.hash }}';profile_view_form.submit();">{{ comment.user.username }}</a>
                    <div class="message">
                        <a class="message_text font_light">{{ comment.content }}</a>
                    </div>
                    {{ comment.sent_date_time|naturaltime }}
                </div>
            </div>
                {% endif %} 
            {% endfor %}
            <div id="chat_spacer" class="message_user spacer">&nbsp;</div>
        </div>
        <div id="scroll_bottom_chat" class="item cur_pointer_dark" onclick="scrollToBottom();">
            <i class="item_icon fa fa-arrow-down font_light"></i>
            <a class="item_text font_light">{% trans "Scroll to bottom" %}</a>
        </div>
        <div id="send_form" class="sender bottom width_600">
            <i class="fa fa-microphone sender_icon cur_pointer_dark font_light fa-fade-hover"></i>
            <input id="chat_message_input" class="sender_input cur_text_dark font_light" name="content" type="text" placeholder="{% trans 'Type a message' %}">
            <i class="fa fa-plus-square sender_icon cur_pointer_dark font_light fa-beat-hover"></i>
            <i id="chat_message_submit" class="fa fa-paper-plane sender_icon cur_pointer_dark font_light fa-shake-hover" onclick="send_comment();"></i>
        </div>
        {% endif %}
    {% endwith %}
        <div class="shadow_2">&nbsp;</div>
    </div>

    <div id="side" class="side">
        <div class="notification_bar" onmouseover="bell_icon.classList.add('fa-shake');" onmouseout="bell_icon.classList.remove('fa-shake');">
            {% if friend_requests %}
                <i id="bell_icon" class="notification_bar_icon fa fa-bell font_light fa-shake"></i>
                <a class="notification_bar_text font_light">{% trans "Notifications" %}</a>
                <div class="badge right">
                <a class="badge_text font_light">{{ friend_requests|length }}</a>
            {% else %}
                <i id="bell_icon" class="notification_bar_icon fa fa-bell font_light fa-shake-hover"></i>
                <a class="notification_bar_text font_light">{% trans "Notifications" %}</a>
                <div class="badge right">
                <a class="badge_text font_light">0</a>
            {% endif %}
            </div>

        </div>
        {% if friend_requests %}
        <div id="friend_requests_grouper" class="grouper">
            <i class="fa fa-angle-down font_light"></i>
            <a class="grouper_text font_light">{% trans "FRIEND REQUESTS" %}</a>
            <i class="fa fa-circle font_red font_8"></i>
        </div>
            {% for friend_request in friend_requests %}
        <div class="item cur_pointer_dark dropdown dropbtn" onclick="on_dropdown_click(dropdown_request_{{ friend_request.id }});">
            <img src="{{ friend_request.sender.image.url }}" class="item_img"></img>
            <a class="item_text font_light">{{ friend_request.sender.username }}</a>
            <i class="profile_bar_i fa fa-ellipsis-vertical cur_pointer_dark dropbtn font_light"></i>
            <div id="dropdown_request_{{ friend_request.id }}" class="dropdown-content">
                <div class="drop_item horizontal">
                    <i class="drop_item_icon fa fa-user font_light"></i>
                    <a class="drop_item_text font_light">{% trans "Profile" %}</a>
                </div>
                <div class="drop_item horizontal" onclick="window.location='{% url 'friend_request_accept' friend_request.sender.email %}';">
                    <i class="drop_item_icon fa fa-check font_green font_light"></i>
                    <a class="drop_item_text font_light">{% trans "Accept" %}</a>  
                </div>
                <div class="drop_item horizontal" onclick="window.location='{% url 'friend_request_decline' friend_request.sender.email %}';">
                    <i class="drop_item_icon fa fa-cancel font_red font_light"></i>
                    <a class="drop_item_text font_light">{% trans "Decline" %}</a>
                </div>
            </div>
        </div>
            {% endfor %}
        {% endif %}
    </div>

</section>
<section id="friend_section" class="section z_10">
    <div class="box center">
        <div class="box_head">
            <a class="box_head_title">{% trans 'Request Friend' %}</a>
            <i class="fa fa-close box_head_cancel cur_pointer_dark" onclick="close_section(friend_section);"></i>
        </div>
        <div class="box_body">
            <div class="field">
                <label class="label">{% trans "Username:" %}</label>
                <input id="friend_request_form_input" class="input cur_text_dark font_light" type="text" name="username" placeholder="{% trans 'Example' %}">
                <a id="friend_request_form_error" class="error">{{ friend_request_form_errors }}</a>
            </div>
        </div>
        <div class="box_footer">
            <button class="button cur_pointer_dark" onclick="friend_request();">{% trans "Send Request" %}</button>
        </div>
    </div>
</section>
<section id="post_section" class="section z_10">
    <div class="box center">
        <form method="post" action="{% url 'create_post' %}" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="box_head">
                <a class="box_head_title">{% trans 'Create Post' %}</a>
                <i class="fa fa-close box_head_cancel cur_pointer_dark" onclick="close_section(post_section);"></i>
            </div>
            <div class="box_body">
                <div class="field">
                    <label class="label">{% trans "Description:" %}</label>
                    <textarea id="post_form_content_input" maxlength="249" class="input resize_none cur_text_dark font_light" type="text" name="content" placeholder="{% trans 'Type something...' %}" oninput="TextArea(this);"></textarea>
                    <a id="friend_request_form_error" class="error">{{ friend_request_form_errors }}</a>
                </div>
                <div class="field">
                    <label class="label">{% trans "Image:" %}</label>
                    <input id="post_form_image_input" class="input cur_pointer_dark font_light" type="file" name="image" accept="image/*">
                    <a id="friend_request_form_error" class="error">{{ friend_request_form_errors }}</a>
                </div>
            </div>
            <div class="box_footer">
                <button type="submit" class="button cur_pointer_dark">{% trans "Share Post" %}</button>
            </div>
        </form>
    </div>
</section>
<section id="edit_post_section" class="section z_10">
    <div class="box center">
        <form id="edit_post_form" method="post" enctype="multipart/form-data">
            {% csrf_token %}
            <div class="box_head">
                <a class="box_head_title">{% trans 'Edit Post' %}</a>
                <i class="fa fa-close box_head_cancel cur_pointer_dark" onclick="close_section(edit_post_section);"></i>
            </div>
            <div class="box_body">
                <div class="field">
                    <label class="label">{% trans "Description:" %}</label>
                    <textarea id="edit_post_form_content_input" maxlength="249" class="input resize_none cur_text_dark font_light" type="text" name="content" placeholder="{% trans 'Type something...' %}" oninput="TextArea(this);"></textarea>
                    <a id="friend_request_form_error" class="error">{{ friend_request_form_errors }}</a>
                </div>
                <div class="field">
                    <label class="label">{% trans "Image:" %}</label>
                    <input id="edit_post_form_image_input" class="input cur_pointer_dark font_light" type="file" name="image" accept="image/*">
                    <a id="friend_request_form_error" class="error">{{ friend_request_form_errors }}</a>
                </div>
                <div class="field horizontal align_vertical_center">
                    <label class="label margin_right_20">{% trans "Do not use image:" %}</label>
                    <input id="edit_post_form_checkbox" class="input cur_pointer_dark font_light" name="delete_image" type="checkbox">
                </div>
            </div>
            <div class="box_footer horizontal">
                <div onclick="delete_post_form.submit();" class="button cur_pointer_dark red">{% trans "Delete Post" %}</div>
                <div class="center">&nbsp;</div>
                <button type="submit" class="button cur_pointer_dark">{% trans "Save Post" %}</button>
            </div>
        </form>
    </div>
</section>
<section id="edit_profile_section" class="section z_10">
    <div class="box center">
        <form id="edit_profile_form" method="post" enctype="multipart/form-data" action="{% url 'edit_profile' request.user.pk %}">
            {% csrf_token %}
            <div class="box_head">
                <a class="box_head_title">{% trans 'Edit Profile' %}</a>
                <i class="fa fa-close box_head_cancel cur_pointer_dark" onclick="close_section(edit_profile_section);"></i>
            </div>
            <div class="box_body">
                <div class="field">
                    <label class="label">{% trans "Image:" %}</label>
                    <input id="edit_post_form_image_input" class="input cur_pointer_dark font_light" type="file" name="image" accept="image/*">
                    <a id="friend_request_form_error" class="error">{{ friend_request_form_errors }}</a>
                </div>
            </div>
            <div class="box_footer">
                <button class="button cur_pointer_dark" type="submit">{% trans "Save Profile" %}</button>
            </div>
        </form>
    </div>
</section>
<section id="image_section" class="section z_10" onclick="close_section(image_section);">
    <div class="image_section box center">
        <div class="box_body">
            <div class="field">
                <img id="image_section_image"/>
            </div>
        </div>
    </div>
</section>
{% endblock content %}

{% block scripts %}
<a style="display:none;" id="trans_friend_requests">{% trans "FRIEND REQUESTS" %}</a>
<a style="display:none;" id="trans_sent_friend_requests">{% trans "SENT FRIEND REQUESTS" %}</a>
<a style="display:none;" id="trans_profile">{% trans "Profile" %}</a>
<a style="display:none;" id="trans_accept">{% trans "Accept" %}</a>
<a style="display:none;" id="trans_decline">{% trans "Decline" %}</a>
    {{ request.user.username|json_script:"json-userName" }}
    {{ request.user.email|json_script:"json-userEmail" }}
    {{ request.user.hash|json_script:"json-userHash" }}
    {% with friend=request.GET.dm|default:'' %}
        {% if friend != '' %}
            {{ roomToken|json_script:"json-roomToken" }}
            <script src="{% static 'scripts/chatsocket.js' %}"></script>
        {% endif %}
    {% endwith %}
    {% with post_detail=request.GET.pd|default:'' %}
        {% if post_detail != '' %}
            {{ post.hash|json_script:"json-postHash" }}
            <script src="{% static 'scripts/postsocket.js' %}"></script>
        {% endif %}
    {% endwith %}
<script src="{% static 'scripts/main.js' %}"></script>
{% endblock scripts %}